# WEB SCRAPPING IN R

---
---
---

This Project is focused towards Web Scrapping in R and performing basic data manipulation.\
The Website ("<https://www.jumia.com.ng/mlp-jumia-express-top-deals/mobile-phones/>") used was an eCommerce website (Jumia), which is a popular eCommerce site here in Nigeria.

Libraries used were:

1) rvest - short for "harvest", which was used to scrape the data.

2) stringr - which was used for sting manipulation.

Loading the Libraries

```{r}
library(rvest)

library(stringr)
```

The link used was assigned the be variable "link" for readability.

```{r}
link= "https://www.jumia.com.ng/mlp-jumia-express-top-deals/mobile-phones/"
```

## DATA IMPORT

The link was read into the environment using "read_html()" function into the variable "webpage"

```{r}
webpage = read_html(link)
```

## 

The specific data elements we want on the page can be fetched by referring to their tag names.

Here, "html_nodes" was used to fetched fetch the elements of the tag name specified, and "html_text2" converted them to texts.

```{r}
product = html_nodes(webpage, ".name") %>% 
  html_text2()

product[1:5]
```

The Original Prices of the products were gotten from the tag name. There was a promo going on as at the time of scrapping this project, hence the variable name.

```{r}
original_price = webpage %>% 
  html_nodes(".old") %>% 
  html_text()


original_price[1:5]
```

The discount price was gotten from its tag name as well.

```{r}
discounted_price = webpage %>% 
  html_nodes(".prc") %>%
  html_text()

discounted_price[1:5]
```

The discount rate was also gotten the same as well.

```{r}
discount = webpage %>% 
  html_nodes("._sm") %>% 
  html_text()

discount[1:5]
```

## DATA MANIPULATION

For the data assigned to variable "product", we could see that it is a string of characters about the full description of the Phones, but this is not suitable for a data frame, and the contents can be separated to give a much readable description of the products.

So, we will make it readable and suitable for a data frame.

Here, Regular Expressions will be used together with the "stringr" package loaded above to manipulate the data for accurate results.

```{r}
product[1:5]
```

#### Extracting the product names.

Regular Expressions used there were:

1) (?= \\\\d) - this was used to "lookahead" of any occurrence of digits with a space behind them.

2) (\\\\d\| \|\\\\w)\* - this was used to select all the whitespaces, zero or more(\*)

Combining both together, we have: "lookahead of any digit with a space behind, and select zero or more characters with spaces and digits behind them) and extract the strings"

```{r}
name = str_extract(product, "(\\d| |\\w)*(?= \\d)")

name[1:5]
```

### Extracting the RAM.

The Regular Expressions used:

1) [\\\\d] - any digits

2) (GB\|gb\|GB/) - any characters that match with "GB" or "gb" or "GB/"

3) ( \|) - any occurrence of a space or not.

4) (RAM\|ram\|) - any occurrence of characters that match "RAM" or "ram" or an empty character.

combining all, we have, "extract all the digits that have any variations of the characters of RAM specified that comes before the occurrence of any white-space (or none), which comes before any variation of "RAM" specified or none."

```{r}
pre_ram = str_extract(product, pattern= "[\\d](GB|gb|GB/)( |)(RAM|ram|)")

pre_ram[1:5]
```

The output gotten (as seen above) contains some redundant words, and we are only interested in the digits (or the first character).

So, we will use the the the "str_sub" function to extract exactly what we are interested in, which was the first character of the output, which is specified below.

```{r}

ram= str_sub(pre_ram, start= 0, end= 1)

ram[1:5]
```

### Extracting the ROM

Almost the same thing that was applied to extract the RAM above will the applied to extract the ROM, the only difference is the usage of two dots.

"Extract the two characters that have the occurrences of any variations of "GB" in front it, that comes before the existence of a space (or not), which comes before the existence of any variation of "ROM" specified."

```{r}
pre_rom = str_extract(product, pattern= "..(GB|gb)( |)(ROM|rom)")

pre_rom[1:5]
```

The digits will be extracted below. Here, I used Regular Expressions to extract the digits as it's more flexible.

(\\\\d\\\\d) - 2 digits

(\\\\d\|\\\\d\|\\\\d) - 3 digits

The code will extract 2 or more digits in the output above.

```{r}
rom = str_extract(pre_rom, "(\\d\\d|\\d\\d\\d)")

rom[1:5]
```

### Extracting the Colors

The code used::

1) (?\<= - \| -): "lookabehind any occurence of 'whitespace hyphen whitespace ( - )' or 'whitespace hypen ( -)'"

2) (\\w\| )\* : select all the words or whiteaspaces.

Combining them, "lookahead of any occurrence of any 'whitespace hyphen whitespace' or 'whitespace hyphen' and select all the words that come after them with or without whitespaces"

```{r}
color = str_extract(product, "(?<= - | -)(\\w| )*")

color[1:5]
```

# LOADING AS A DATAFRAME

After the successful manipulation of the data, it will be loaded into a dataframe as shown below:

```{r}
phones = data.frame(
  name = name,
  ram= ram,
  internal_storage= rom,
  color= color,
  original_price = original_price,
  discount = discount,
  discounted_price = discounted_price
)


```

And, the first 5 rows will be loaded to confirm the result.

```{r fig.width=500}
head(phones)
```
